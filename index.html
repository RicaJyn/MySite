<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Gallery</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Work+Sans:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #fdfcfa;
            --bg-secondary: #f5f3ef;
            --text-primary: #1a1410;
            --text-secondary: #635e56;
            --accent: #8b7355;
            --accent-hover: #6d5940;
            --border: #e4e0d8;
            --shadow: rgba(0, 0, 0, 0.08);
            --overlay: rgba(0, 0, 0, 0.6);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1410;
            --bg-secondary: #252119;
            --text-primary: #f5f3ef;
            --text-secondary: #b8b3aa;
            --accent: #c4a57b;
            --accent-hover: #d4b88f;
            --border: #3a342a;
            --shadow: rgba(0, 0, 0, 0.3);
            --overlay: rgba(0, 0, 0, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Work Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            color: var(--text-primary);
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.6rem 1.4rem;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'Work Sans', sans-serif;
            font-size: 0.875rem;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .btn:hover {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .btn-primary {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            border-color: var(--accent-hover);
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1.25rem;
            padding: 0.5rem;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover {
            transform: rotate(20deg);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 6rem 2rem 3rem;
        }

        .album-header {
            text-align: center;
            margin-bottom: 3rem;
            opacity: 0;
            animation: fadeInUp 0.8s ease forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(20px);
            }
        }

        .album-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            letter-spacing: 1px;
        }

        .album-subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
            font-weight: 300;
            margin-bottom: 1rem;
        }

        .album-description {
            font-size: 0.95rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.7;
        }

        .albums-nav {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            scrollbar-width: thin;
            scrollbar-color: var(--accent) var(--bg-secondary);
        }

        .albums-nav::-webkit-scrollbar {
            height: 6px;
        }

        .albums-nav::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        .albums-nav::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 3px;
        }

        .album-tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .album-tab:hover,
        .album-tab.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .admin-controls {
            display: none;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .admin-controls.visible {
            display: flex;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .photo-item {
            position: relative;
            aspect-ratio: 4/3;
            overflow: hidden;
            background: var(--bg-secondary);
            cursor: pointer;
            border: 1px solid var(--border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .photo-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px var(--shadow);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .photo-item:hover img {
            transform: scale(1.05);
        }

        .photo-controls {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            display: none;
            gap: 0.5rem;
        }

        .admin-controls.visible ~ .photo-grid .photo-controls {
            display: flex;
        }

        .photo-btn {
            padding: 0.5rem;
            background: var(--overlay);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background 0.3s ease;
        }

        .photo-btn:hover {
            background: var(--accent);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--overlay);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--bg-primary);
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--border);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.75rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-family: 'Work Sans', sans-serif;
            font-size: 0.95rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--overlay);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .lightbox.active {
            display: flex;
            opacity: 1;
        }

        .lightbox-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }

        .lightbox-img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
        }

        .lightbox-close {
            position: absolute;
            top: -2.5rem;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .file-upload {
            display: none;
        }

        .upload-btn {
            display: inline-block;
            padding: 0.6rem 1.4rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .upload-btn:hover {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }

            .logo {
                font-size: 1.25rem;
            }

            .album-title {
                font-size: 2rem;
            }

            .photo-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 1rem;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">Gallery</div>
        <div class="header-controls">
            <button class="theme-toggle" onclick="toggleTheme()">‚óê</button>
            <button class="btn" id="loginBtn" onclick="showLoginModal()">Admin</button>
            <button class="btn" id="logoutBtn" onclick="logout()" style="display: none;">Logout</button>
        </div>
    </header>

    <div class="container">
        <div class="album-header" id="albumHeader">
            <h1 class="album-title" id="albumTitle">My Collection</h1>
            <p class="album-subtitle" id="albumSubtitle"></p>
            <p class="album-description" id="albumDescription"></p>
        </div>

        <div class="albums-nav" id="albumsNav"></div>

        <div class="admin-controls" id="adminControls">
            <button class="btn btn-primary" onclick="showCreateAlbumModal()">Create Album</button>
            <button class="btn" onclick="showEditAlbumModal()">Edit Album</button>
            <button class="btn" onclick="deleteCurrentAlbum()">Delete Album</button>
            <button class="btn" onclick="toggleFavoriteAlbum()">Set as Favorite</button>
            <button class="btn btn-primary" onclick="document.getElementById('photoUpload').click()">Add Photos</button>
            <input type="file" id="photoUpload" class="file-upload" accept="image/*" multiple onchange="handlePhotoUpload(event)">
        </div>

        <div class="photo-grid" id="photoGrid"></div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2 class="modal-header">Admin Login</h2>
            <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" class="form-input" id="username" placeholder="Enter username">
            </div>
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" class="form-input" id="password" placeholder="Enter password">
            </div>
            <div class="form-actions">
                <button class="btn btn-primary" onclick="login()">Login</button>
                <button class="btn" onclick="closeModal('loginModal')">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Create/Edit Album Modal -->
    <div class="modal" id="albumModal">
        <div class="modal-content">
            <h2 class="modal-header" id="albumModalTitle">Create Album</h2>
            <div class="form-group">
                <label class="form-label">Title *</label>
                <input type="text" class="form-input" id="albumTitleInput" placeholder="Enter album title">
            </div>
            <div class="form-group">
                <label class="form-label">Subtitle</label>
                <input type="text" class="form-input" id="albumSubtitleInput" placeholder="Enter subtitle (optional)">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-textarea" id="albumDescriptionInput" placeholder="Enter description (optional)"></textarea>
            </div>
            <div class="form-actions">
                <button class="btn btn-primary" onclick="saveAlbum()">Save</button>
                <button class="btn" onclick="closeModal('albumModal')">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <div class="lightbox-content" onclick="event.stopPropagation()">
            <button class="lightbox-close" onclick="closeLightbox()">√ó</button>
            <img class="lightbox-img" id="lightboxImg" src="" alt="">
        </div>
    </div>

    <script>
        // Encryption function using SHA-256
        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);
            const hash = await crypto.subtle.digest('SHA-256', data);
            return Array.from(new Uint8Array(hash))
                .map(b => b.toString(16).padStart(2, '0'))
                .join('');
        }

        // Admin credentials (password hash for "HisMasterpiece")
        const ADMIN_USERNAME = 'ricajyn';
        const ADMIN_PASSWORD_HASH = 'e8c5c0c5e5f5d5e5f5c5e5d5c5e5f5d5e5c5e5d5c5e5f5d5e5c5e5d5c5e5f5d5'; // Placeholder, will be set on first run

        // Initialize password hash
        (async function initPasswordHash() {
            const stored = localStorage.getItem('adminPasswordHash');
            if (!stored) {
                const hash = await hashPassword('HisMasterpiece');
                localStorage.setItem('adminPasswordHash', hash);
            }
        })();

        // Data structure
        let albums = [];
        let currentAlbumId = null;
        let isAdmin = false;
        let editingAlbumId = null;

        // Initialize
        function init() {
            loadData();
            checkTheme();
            displayAlbums();
            displayCurrentAlbum();
        }

        // Load data from localStorage
        function loadData() {
            const stored = localStorage.getItem('photoAlbums');
            if (stored) {
                albums = JSON.parse(stored);
            } else {
                // Create default album
                albums = [{
                    id: Date.now(),
                    title: 'My Collection',
                    subtitle: 'A curated selection',
                    description: 'Welcome to my photo gallery',
                    photos: [],
                    isFavorite: true
                }];
                saveData();
            }
            
            // Set current album to favorite or first album
            const favoriteAlbum = albums.find(a => a.isFavorite);
            currentAlbumId = favoriteAlbum ? favoriteAlbum.id : albums[0].id;
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('photoAlbums', JSON.stringify(albums));
        }

        // Display albums navigation
        function displayAlbums() {
            const nav = document.getElementById('albumsNav');
            nav.innerHTML = '';
            
            albums.forEach(album => {
                const tab = document.createElement('div');
                tab.className = 'album-tab' + (album.id === currentAlbumId ? ' active' : '');
                tab.textContent = album.title + (album.isFavorite ? ' ‚òÖ' : '');
                tab.onclick = () => switchAlbum(album.id);
                nav.appendChild(tab);
            });
        }

        // Switch album
        function switchAlbum(albumId) {
            currentAlbumId = albumId;
            displayAlbums();
            displayCurrentAlbum();
        }

        // Display current album
        function displayCurrentAlbum() {
            const album = albums.find(a => a.id === currentAlbumId);
            if (!album) return;

            document.getElementById('albumTitle').textContent = album.title;
            document.getElementById('albumSubtitle').textContent = album.subtitle || '';
            document.getElementById('albumDescription').textContent = album.description || '';

            const grid = document.getElementById('photoGrid');
            grid.innerHTML = '';

            if (album.photos.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì∑</div>
                        <p>No photos yet</p>
                        ${isAdmin ? '<p style="margin-top: 1rem; font-size: 0.875rem;">Click "Add Photos" to get started</p>' : ''}
                    </div>
                `;
                return;
            }

            album.photos.forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'photo-item';
                item.innerHTML = `
                    <img src="${photo}" alt="Photo ${index + 1}" onclick="openLightbox('${photo}')">
                    <div class="photo-controls">
                        ${index > 0 ? `<button class="photo-btn" onclick="movePhoto(${index}, -1)" title="Move left">‚Üê</button>` : ''}
                        ${index < album.photos.length - 1 ? `<button class="photo-btn" onclick="movePhoto(${index}, 1)" title="Move right">‚Üí</button>` : ''}
                        <button class="photo-btn" onclick="deletePhoto(${index})" title="Delete">√ó</button>
                    </div>
                `;
                grid.appendChild(item);
            });
        }

        // Login
        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username !== ADMIN_USERNAME) {
                alert('Invalid credentials');
                return;
            }

            const hash = await hashPassword(password);
            const storedHash = localStorage.getItem('adminPasswordHash');

            if (hash === storedHash) {
                isAdmin = true;
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('logoutBtn').style.display = 'block';
                document.getElementById('adminControls').classList.add('visible');
                closeModal('loginModal');
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            } else {
                alert('Invalid credentials');
            }
        }

        // Logout
        function logout() {
            isAdmin = false;
            document.getElementById('loginBtn').style.display = 'block';
            document.getElementById('logoutBtn').style.display = 'none';
            document.getElementById('adminControls').classList.remove('visible');
        }

        // Show login modal
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }

        // Show create album modal
        function showCreateAlbumModal() {
            editingAlbumId = null;
            document.getElementById('albumModalTitle').textContent = 'Create Album';
            document.getElementById('albumTitleInput').value = '';
            document.getElementById('albumSubtitleInput').value = '';
            document.getElementById('albumDescriptionInput').value = '';
            document.getElementById('albumModal').classList.add('active');
        }

        // Show edit album modal
        function showEditAlbumModal() {
            const album = albums.find(a => a.id === currentAlbumId);
            if (!album) return;

            editingAlbumId = currentAlbumId;
            document.getElementById('albumModalTitle').textContent = 'Edit Album';
            document.getElementById('albumTitleInput').value = album.title;
            document.getElementById('albumSubtitleInput').value = album.subtitle || '';
            document.getElementById('albumDescriptionInput').value = album.description || '';
            document.getElementById('albumModal').classList.add('active');
        }

        // Save album
        function saveAlbum() {
            const title = document.getElementById('albumTitleInput').value.trim();
            if (!title) {
                alert('Title is required');
                return;
            }

            const subtitle = document.getElementById('albumSubtitleInput').value.trim();
            const description = document.getElementById('albumDescriptionInput').value.trim();

            if (editingAlbumId) {
                // Edit existing album
                const album = albums.find(a => a.id === editingAlbumId);
                if (album) {
                    album.title = title;
                    album.subtitle = subtitle;
                    album.description = description;
                }
            } else {
                // Create new album
                albums.push({
                    id: Date.now(),
                    title,
                    subtitle,
                    description,
                    photos: [],
                    isFavorite: false
                });
            }

            saveData();
            displayAlbums();
            displayCurrentAlbum();
            closeModal('albumModal');
        }

        // Delete current album
        function deleteCurrentAlbum() {
            if (albums.length === 1) {
                alert('Cannot delete the last album');
                return;
            }

            if (confirm('Are you sure you want to delete this album?')) {
                albums = albums.filter(a => a.id !== currentAlbumId);
                currentAlbumId = albums[0].id;
                saveData();
                displayAlbums();
                displayCurrentAlbum();
            }
        }

        // Toggle favorite album
        function toggleFavoriteAlbum() {
            albums.forEach(a => a.isFavorite = false);
            const album = albums.find(a => a.id === currentAlbumId);
            if (album) {
                album.isFavorite = true;
            }
            saveData();
            displayAlbums();
        }

        // Handle photo upload
        function handlePhotoUpload(event) {
            const files = event.target.files;
            if (!files.length) return;

            const album = albums.find(a => a.id === currentAlbumId);
            if (!album) return;

            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    album.photos.push(e.target.result);
                    saveData();
                    displayCurrentAlbum();
                };
                reader.readAsDataURL(file);
            });

            event.target.value = '';
        }

        // Move photo
        function movePhoto(index, direction) {
            const album = albums.find(a => a.id === currentAlbumId);
            if (!album) return;

            const newIndex = index + direction;
            if (newIndex < 0 || newIndex >= album.photos.length) return;

            [album.photos[index], album.photos[newIndex]] = [album.photos[newIndex], album.photos[index]];
            saveData();
            displayCurrentAlbum();
        }

        // Delete photo
        function deletePhoto(index) {
            if (confirm('Delete this photo?')) {
                const album = albums.find(a => a.id === currentAlbumId);
                if (!album) return;

                album.photos.splice(index, 1);
                saveData();
                displayCurrentAlbum();
            }
        }

        // Open lightbox
        function openLightbox(src) {
            document.getElementById('lightboxImg').src = src;
            document.getElementById('lightbox').classList.add('active');
        }

        // Close lightbox
        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        // Check theme
        function checkTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        // Close modals on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal('loginModal');
                closeModal('albumModal');
                closeLightbox();
            }
        });

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
